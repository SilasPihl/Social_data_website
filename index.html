<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>Project B- 02806 F18 at DTU</title>
    <meta charset="utf-8" />
    <script src="js/d3.v4.min.js"></script>
    <script src="js/lodash.min.js"></script>
    <script src="js/graph-scroll.js"></script>
    <script src="js/d3-simple-slider.js"></script>

    <!--jQuery CDN-->
    <script src="js/jquery-3.3.1.min.js"></script>
    <!--Bootstrap-->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <link  href="bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="style/main.css">

    <script type="text/javascript">
      function showHide(className, displayState) {
        var elements = document.getElementsByClassName(className);
        
        for (var i = 0; i < elements.length; i++){
            elements[i].style.display = displayState;
        }
      }

      function includeHTML() {
        var z, i, elmnt, file, xhttp;
        /*loop through a collection of all HTML elements:*/
        z = document.getElementsByTagName("*");
        for (i = 0; i < z.length; i++) {
          elmnt = z[i];
          /*search for elements with a certain atrribute:*/
          file = elmnt.getAttribute("w3-include-html");
          if (file) {
            /*make an HTTP request using the attribute value as the file name:*/
            xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4) {
                if (this.status == 200) {elmnt.innerHTML = this.responseText;}
                if (this.status == 404) {elmnt.innerHTML = "Page not found.";}
                /*remove the attribute, and call this function once more:*/
                elmnt.removeAttribute("w3-include-html");
                includeHTML();
              }
            }      
            xhttp.open("GET", file, true);
            xhttp.send();
            /*exit the function:*/
            return;
          }
        }
      };      
    </script>
</head>
<body>

  <div class="row" style="margin-left:20px">
    <div class="col-2"></div>
    <div class="col-8">
      <div class="row">
        <h1 class="col-9 header">An insight into accidents in New York</h1>
        <div class="col-3 justify-content-center">
            <div class="text-right">
              <a style="padding: .375rem .75rem;" href="https://github.com/SilasPihl/Social_data_website/" target="_blank">Public Github Repo</a>
            </div>
            <div class="text-right explainer-content">
              <button class="btn btn-link" type="button" onclick="showHide('main-d3-content', 'block'); showHide('explainer-content', 'none');" >Show Main Project Page</button>
            </div>
            <div class="text-right main-d3-content">
              <button class="btn btn-link"   type="button" onclick="showHide('main-d3-content', 'none'); showHide('explainer-content', 'block');">Show Explainer book</button>
            </div>
        </div>
      </div>

      <hr class="line thick" />

      <h4 class="subtitle">Project B - 02806 Social Data Analysis and Visualizations F18 at DTU</h4>

      <div class="explainer-content">
        <div w3-include-html="explainer.html"></div> 
      </div>

      <div class="main-d3-content" >
        
        <p>
          New York City has been scored to be the third most congested city in the world by <a href="http://inrix.com/scorecard/">Inrix</a>. In fact it has become so bad that a new initiative, <a href="http://www1.nyc.gov/site/visionzero/index.page">Vision Zero</a>, was launched in 2014, with a goal of reducing annual traffic deaths by 50% by the year 2025. It has succeeded in reducing the total number of people killed anually in traffic. It is still not completely safe to be in traffic in New York. 
        </p>
        <p>
          But which areas are the most dangerous? And since it is so congested where are you most likely to have your new car dented?
        </p>
        <p>
          The data set from <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i">OpenNYC</a> has been used. It has been filtered to only include the years 2017 and 2018, and only include data that has correctly been designated a borough, meaning any data with a miss match of borough ID and latitude longitude location has been removed. The miss matched data accounts for roughly 33% of the original dataset, including the removal of data without a designated borough. To make the visualizations run a lot smoother we have elected to only use every 30th data point. Even though this will make the data less precise, our objective is to give an overview of the data and focus on the narrative, and we feel this will be better shown with less cluttered data.
        </p>
        <div class="justify-content-center text-center">
          <svg id="d3_bubbles" font-family="sans-serif" font-size="10" text-anchor="middle"></svg>
        </div>
        <p>
          The above buble chart shows the most common contributing factos for car accidents. The top 5 contributing factors are making up 69.1% of the accidents, and they are factors which could be easily be remedied by drivers being more attentive or more patient. Driver inattention - don’t do other things while driving. Following too closely - use the two second rule. Failure to Yield Right-of-Way - have patience. Passing or Lane Usage Improper - remember to only pass on the left, even if the car infront is slow. Backing unsafely - remember to look around and back out slowly. This sort of knowledge could be very useful when targeting methods for a safer traffic, as seen in New York’s current traffic initiative ‘Vision Zero’.
        </p>
        <p>
        </p>
      </div> <!-- end of main-d3-content -->

      <hr>

    </div>  <!-- end of title, middle column -->
    <div class="col-2"></div>

  </div>  <!-- end of title panel row -->

  <div class="main-d3-content" >

    <div id="fixedcontainer">

      <div class="" id="fixedarea">
        <div class="row">
          <div class="col-10">
            <div class="text-center align-items-center">

              <div class="row">
                <div class="col-7 text-center align-items-center ">
                  <h5>Timeseries of accidents</h5>
                  <div class="row justify-content-md-center pt-1" >
                    <div class="col" style="text-align:right">
                      Avg. over no. of days<br/>
                    </div>
                    <!-- <div> -->
                      <div class="col" id="line_svg_slider"></div>
                    <!-- </div> -->
                    <div class="col std-button" style="text-align:left">
                      <button type="button" class="btn-outline-primary btn btn-xs  std-button" id="reset_line_svg_slider"  onclick="reset_line_svg_slider();reset_brush();">Reset all</button>
                      <button type="button" class="btn-outline-primary btn btn-xs  std-button" id="animate_button"  onclick="animate_time();">Animate</button>
                    </div>
                  </div>  
                  <!-- style="height: 40px;" -->
                  <div id="d3_linechart" height="400px" width="600px"></div>

                  <h5>Bar chart of accidents per hour</h5>
                  <div class="text-center">
                    <div id="d3_bar"></div>
                  </div>
                </div>
                  
                <div class="col-5">
                  <h5>Map of accidents at location</h5>
       
                  <div class="text-center">
                    <div id="d3_map" ></div>
                  </div> 
                  <div>
                      <button type="button" data-toggle="button" 
                      class="active btn-outline-primary btn borough-button"
                      id="BrooklynBtn"
                      onclick="toggleBrooklyn();">Brooklyn</button>
                      <!--  <img src="suv.png" alt="" id ="carbutton" style="width:50px;height:50px;"></button>-->
                      <button type="button" data-toggle="button" 
                        class="active btn-outline-primary btn borough-button"
                        id="QueensBtn" 
                        onclick="toggleQueens();">
                      Queens</button>
                      <button type="button" data-toggle="button" 
                        class="active btn-outline-primary btn borough-button"
                        id="ManhattanBtn" 
                        onclick="toggleManhattan();">
                      Manhattan</button>
                      <button type="button" data-toggle="button" 
                        class="active btn-outline-primary btn borough-button"
                        id="BronxBtn" 
                        onclick="toggleBronx();">
                      Bronx</button>
                      <button type="button" data-toggle="button" 
                        class="active btn-outline-primary btn borough-button"
                        id="StatenIslandBtn" 
                        onclick="toggleStatenIsland();">
                      Staten Island</button>
                      
                    </div>
                </div>      
              </div> <!-- end of 7-5 row -->

              <hr class="line" />
              <!-- <div>
                Data from: <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i">https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i</a>
              </div>  -->
            </div> 


          </div>
          <div class="col-2">
            <div class="right-skip" >
              <div class="btn-group btn-group-vertical">
                <button type="button" data-toggle="button" 
                        class="rounded btn-outline-primary btn"
                        id="toggleAnimations" 
                        onclick="toggleAutomateAnimations();">
                      Animate<br/>
                    on scroll</button>
                <button id="go-to-bottom" style="margin-top: 5px;"class="rounded btn btn-outline-primary">Bottom</button>
              </div>
            </div>
          </div>
        </div>
      </div>    <!-- end of fixedarea -->  
      <div id="steps" class="text-center">
        <div class="step"></div>
        <div class="step" >
          <h1>Intro</h1>
          <p>
             Fell free to change the graphs at any time. Brush any area and see the changes. When you scroll down a new information box will appear. Go ahead.
          </p>

        </div>

        <div class="step" >
          <h1>Animations</h1>
          <p>
            Many of these information boxes will can activate an animation in the charts. You can click the information button to activate it or you can activate automatic animation on scroll by clicking the button in the right pane "Animate on scroll".   
          </p>

        </div>

        <div class="step" >
          <h1>Airport in Queens</h1>
          <p>
            The southeastern part of Queens, which seems free from accidents, is bare because of JFK International Airport.
          </p>
          <button id="animateAirPort_btn" class="btn btn-outline-primary" onclick="animateAirPort();">See animation!</button>

        </div>
        <div class="step ">
          <h1>Staten Island</h1>
          <p>
            The northwestern part of Staten Island is not completely free of accidents. However, due to our filtering of only using data which has a designated borough, this part is removed. This seems to indicate a systematic error in inputting data.
          </p>
          <button id="animateStatenIsland_btn" class="btn btn-outline-primary" onclick="animateStatenIsland();">See animation!</button>
        </div>
        <div class="step ">
          <h1>Rush hours</h1>
          <p>
            Across the dataset we see peak accident hours are 14:00-15:00 and 16:00-18:00. This must mean that rush hour, when people are travelling home from work, is the most dangerous.
          </p>
          <button id="animateBarChart1418_btn" class="btn btn-outline-primary" onclick="animateBarChart1418();">See animation!</button>
        </div>
        <div class="step">
          <h1>Correlation across data set</h1>
          <p>
            We looked for a correlation between population density and the amount of accidents per inhabitant. Following this hypothesis we thought Manhattan would be the most dangerous. See next..
          </p>
          <button id="animateButtons_1_btn"class="btn btn-outline-primary" onclick="animateButtons_1();">See animation!</button>
        </div>
        <div class="step">
          <h1>Correlation across data set</h1>
          <p>
            But we were unable to find any correlation. On the contrary, Queens with the second lowest density was the most dangerous and the Bronx, with the second highest density, was the least dangerous.
          </p>
          <button id="animateButtons_2_btn"class="btn btn-outline-primary" onclick="animateButtons_2();">See animation!</button>
        </div>

        <div class="step"></div>

      </div>    <!-- end of steps -->
    </div><!-- end of fixedcontainer -->


    <div class="row" style="margin-left:20px">
      <div class="col-2"></div>
      <div class="col-8">
        
      The above was our visualization showcasing traffic accidents in New York. We hope that it has been interesting and we hope you will drive safely, remaining aware of your surroundings.

      </div>  <!-- end of title, middle column -->
      <div class="col-2"></div>
    </div>

  </div> <!-- end of main-d3-content -->

  <script type="text/javascript" src="js/final_assignment.js"> </script>

  <script type="text/javascript">
    showHide('main-d3-content', 'block'); 
    showHide('explainer-content', 'none');
    includeHTML();
  </script>

</body>
</html>
